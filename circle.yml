machine:
  node:
    version: 6.1.0

dependencies:
  pre:
    - if ! which flow 2>/dev/null; then (cd ~ && wget -O flow.zip https://github.com/facebook/flow/releases/download/v0.30.0/flow-linux64-v0.30.0.zip && unzip flow.zip && if [ -f flow ]; then mkdir flow_ && mv flow flow_/ && mv flow_ flow; fi; cd flow && ./flow version && echo -e "\nPATH=\"\$PATH:$(pwd)/\"" >> ~/.bashrc && source ~/.bashrc); fi
  override:
    - ./tools/install-deps.sh

test:
  override:
    - flow check
    - npm test
    - if [ -n "$INBOXSDK_TEST_SECRET" ]; then ./node_modules/.bin/gulp -s && ./node_modules/.bin/wdio; fi

general:
  artifacts:
    - "chromeTestOutput"
